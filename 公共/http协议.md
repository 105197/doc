# http协议原理

## http协议简介

http(超文本协议传输),是一个客户终端（请求）与一个服务端（应答）之间的tcp。

## url回车经历什么？

1. 解析域名。
    * 1.1 首先在浏览器查询缓存，不同的浏览器会储存不同的时间（2-30）

    * 1.2 系统缓存。如果在浏览器找不到，浏览器会调用一个系统调用（windows里是gethostbyname），获取系统的缓存

    * 1.3 路由器缓存，经过上面的查询都不行，会向路由器发送一个请求，进行查询
  
    * 1.4 ISP缓(存互联网服务提供商)，上面不行，要check的就是ISP缓存DNS的服务器。例如：向电信供应商的ISP服务器来查询。

    * 1.5 根域名服务器。当以上均未完成，则进入根服务器进行查询。全球仅有13台根域名服务器，1个主根域名服务器，其余12为辅根域名服务器。根域名收到请求后会查看区域文件记录，若无则将其管辖范围内顶级域名（如.com）服务器IP告诉本地DNS服务器；　　

    * 1.6）顶级域名服务器。顶级域名服务器收到请求后查看区域文件记录，若无则将其管辖范围内主域名服务器的IP地址告诉本地DNS服务器；

    * 1.7）主域名服务器。主域名服务器接受到请求后查询自己的缓存，如果没有则进入下一级域名服务器进行查找，并重复该步骤直至找到正确纪录。

    * 1.5～1.7 为递归搜索 – 你的ISP的DNS服务器从跟域名服务器开始进行递归搜索，从.com顶级域名服务器到Facebook的域名服务器。一般DNS服务器的缓存中会有.com域名服务器中的域名，所以到顶级服务器的匹配过程不是那么必要了。  
 （注：DNS为应用层，是为其他应用层协议工作的，包括不限于HTTP和SMTP以及FTP，用于主机名解析到ip地址：

2. DNS过程：
    * 2.1  浏览器截取url的域名（主机名）发送主机中运行的DNS的客户端
    * 2.2  DNS客户端向DNS服务端发送一份查询报文（主机名与一些缓存查询）
    * 2.3  DNS客户端收到一个回答报文，里面有主机名对应的IP，一旦浏览器收到DNS的IP地址，就可以向该IP的服务器发起TCP连接。）
  
* 3. 浏览器收到IP地址后，向服务器发起一个请求。

* 4. 到传输层选择传输协议，TCP/UDP,TCP是可靠的传输协议，对HTTP请求进行了封装，加入端口号信息

* 5. 到网络层，通过IP协议封装成IP数据报，用到ARP协议，主机发送信息时将包含目标IP地址的ARP请求广播到网络的所有主机，并接收请求数据，来找到对应的MAC地址

* 6. 然后到数据链路层，将网络层的IP数据报添加首部与尾部，封装成MAC帧，建立TCP的三次握手，根据首尾的标记，来识别帧的开始与结束；将中间的数据返回网络层，并层层递交到应用层

* 7. 服务端响应请求并将客户端请求到数据，返回客户端，断开TCP连接。

* 8. 客户端接收到数据，并在浏览器上面运行。

***

## Get、Post、Put、Delete区别

### 根据htpp协议规范，GET用与获取数据源，不会修改数据，是安全的和幂等的。

所谓安全的意味着该操作用于获取信息而非修改信息。换句话说，GET 请求一般不应产生副作用。就是说，它仅仅是获取资源信息，就像数据库查询一样，不会修改，增加数据，不会影响资源的状态。
所谓的幂等：对同一个URl进行多次请求，返回的数据都是一样的。

## 1、请求数据区别

### 1.1、GEt

GET请求是将参数放在URL地址后面，以？分割URL接口地址与数据参数，参数之间以&相连，如：www.baidu.com?usrName='222'&passWord='2222'

### 1.2、POST

POST请求是将数据参数放在HTTP的body上面，即是包体。

### 2、请求数据的大小

### 2.1 GET

一般是以1024字节大小，但是实质上并不是HTTP对GET进行限制，而是浏览器以及服务器对其传输进行了限制。IE对URL长度的限制 是2083字节(2K+35字节)。对于其他浏览器，如FireFox，Netscape等，则没有长度限制，这个时候其限制取决于服务器的操作系统。即 如果url太长，服务器可能会因为安全方面的设置从而拒绝请求或者发生不完整的数据请求。

### 2.2 POST

理论上无限制，但是其大小受服务器对设置和内存大小

### 安全性

### 3.1 POST的安全性要比GET的安全性高。

这里所说的安全性和上面GET提到的“安全”不是同个概念。上面“安全”的含义仅仅是不作数据修改，而这里安全的含义是真正的Security的含义，比如：通过GET提交数据，用户名和密码将明文出现在URL上，因为：
(1)登录页面有可能被浏览器缓存，
(2)其他人查看浏览器的历史纪录，那么别人就可以拿到你的账号和密码了。
(3)使用GET提交数据还可能会造成Cross-site request forgery攻击

### Get是向服务器发索取数据的一种请求，而Post是向服务器提交数据的一种请求,指示执行的机制不一样，并已不是一个取一个发。